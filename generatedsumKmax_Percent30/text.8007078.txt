For each subject, single-shot full Fourier dMRI data were acquired using a twice-refocused dMRI pulse sequence to reduce eddy current artifacts.16 The following imaging parameters were employed for all 3 subjects: TE = 110 ms, TR = 5300 ms, FOV = 222 × 222 mm2, acquisition matrix = 74 × 74, slice thickness = 3 mm, number of slices = 42, phase encoding acceleration factor (GRAPPA) = 2, slice acceleration factor = 2, coil combine mode = adaptive combine, bandwidth = 1648 Hz/px, number of diffusion encoding directions = 128, and b-values = 1000, 2000, and 6000 s/mm2. For CSD, the fODFs were generated by MRTrix3 (http://www.mrtrix.org/) using the ‘fa’ algorithm.23 For FBI, the fODFs were obtained using the inverse generalized Funk transform with intra-axonal diffusivity upper bound parameter D0 set to 3.0 μm2/ms.5,6 With both techniques, the fODFs were represented in terms of spherical harmonics including all even degrees up to 8. 6 where the parameter ε was determined by solving Eq. This number of directions corresponds to an angular resolution of about 2°, which is small in comparison to the angular scale over which the estimated fODFs vary significantly.The FAA for all fODFs was determined using the formula10(18) FAA =3∑m=−22|c2m|25|c00|2+2∑m=−22|c2m|2. In order to calculate the FAA from Eq. This is a much lower peak threshold than is typically employed in the context of fiber tractography.4,7 We chose a small peak threshold in order to highlight the effect of rectification on the total number of peaks. This is a much lower peak threshold than is typically employed in the context of fiber tractography.4,7 We chose a small peak threshold in order to highlight the effect of rectification on the total number of peaks. The step function fODF, in contrast, has a higher MSE than the original fODF in several cases, as is particularly apparent for θc = 15°. The step function fODF, in contrast, has a higher MSE than the original fODF in several cases, as is particularly apparent for θc = 15°. The step function fODF, in contrast, has a higher MSE than the original fODF in several cases, as is particularly apparent for θc = 15°. The main qualitative difference between optimized and step function rectification is that optimized rectification alters the heights of the larger peaks less but suppresses the smaller peaks more strongly. Then we apply the method to both CSD and FBI fODFs estimated using dMRI data obtained from 3 healthy volunteers for a b-value of 6000 s/mm2. This is true for both optimized and step function rectification.Distributions of the number of peaks identified in the original and rectified fODFs for the pooled white matter voxels are plotted in Figure 8. The numerical implementation of our method requires that a solution of Eq. Thus adding optimized rectification as a data processing step should be straightforward regardless of the type of fODF or its method of calculation, and the computational burden would be minimal. Results for the alternative rectification approach of simply setting the negative values to zero, which we call step function rectification, are provided for the sake of comparison. Results for the alternative rectification approach of simply setting the negative values to zero, which we call step function rectification, are provided for the sake of comparison. Rectification was seen to reduce the FAA and the total number of detected peaks with these effects being more substantial for CSD. This was demonstrated explicitly for the mathematical model. Although we have no ground truth to confirm an improved accuracy for in vivo data, the small peaks that it suppresses are prone to being altered by signal noise and imaging artifacts. We have demonstrated this explicitly for the mathematical model. In particular, the results of Figure 2 show that step function rectification often reduces the accuracy of the fODF while optimized rectification improves it. For the in vivo human data, we find that optimized rectification alters the heights of the large peaks less than step function rectification at the same time that it more strongly suppresses small peaks. Without loss of generality, we assume the antipodal symmetry F(−n) = F(n) and the normalization condition We suppose that F(n) may take on negative values in some directions and that we would like to find a rectified fODF, F^(n), with the following properties We suppose that F(n) may take on negative values in some directions and that we would like to find a rectified fODF, F^(n), with the following properties We suppose that F(n) may take on negative values in some directions and that we would like to find a rectified fODF, F^(n), with the following properties We suppose that F(n) may take on negative values in some directions and that we would like to find a rectified fODF, F^(n), with the following properties This condition can also be expressed as This condition can also be expressed as 6 and that there is a unique solution for ε are sketched in the Appendix. with θ being the polar angle for n and θc a cut-off angle. This fODF is zero for θc < θ < π − θc, and it has a constant positive value for 0 ≤ θ < θc and for π − θc ≤ θ < π. This fODF is zero for θc < θ < π − θc, and it has a constant positive value for 0 ≤ θ < θc and for π − θc ≤ θ < π. This fODF is zero for θc < θ < π − θc, and it has a constant positive value for 0 ≤ θ < θc and for π − θc ≤ θ < π. This fODF is zero for θc < θ < π − θc, and it has a constant positive value for 0 ≤ θ < θc and for π − θc ≤ θ < π. where φ is the azimuthal angle for n, Ylm(θ,φ) are the spherical harmonics of degree l and order m, and clm are the expansion coefficients. The expansion coefficients are given explicitly by where Pl(x) is a Legendre polynomial of degree l and δmn is the Kronecker delta. 15 is truncated at a finite degree, as is often done with experimentally determined fODFs, one obtains the approximation where lmax ≡ 2N is the maximum degree for the retained spherical harmonics. where lmax ≡ 2N is the maximum degree for the retained spherical harmonics. 